"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.prepare = void 0;
const detect_license_path_1 = require("./detect-license-path");
const fs_1 = require("fs");
const detect_license_1 = require("./detect-license");
const get_handler_1 = require("./get-handler");
async function prepare({ license }, context) {
    const licensePath = (license === null || license === void 0 ? void 0 : license.path) || await detect_license_path_1.detectLicensePath();
    const content = (await fs_1.promises.readFile(licensePath)).toString();
    const licenseType = await detect_license_1.detectLicense(content);
    const handlerFn = get_handler_1.getHandler(licenseType);
    const replacement = await handlerFn(content, context);
    await fs_1.promises.writeFile(licensePath, replacement);
    context.logger.log(`Updated license file ${licensePath}`);
}
exports.prepare = prepare;
//# sourceMappingURL=prepare.js.map